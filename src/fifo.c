//==================================================================================================
//
// File name: fifo.c
//
// Purpose: Implementation of circular data structure with a "First In, First Out" principle.
//          Note: Wrap-around logic requires the size of the underlying buffer
//                to be a power of two.
//
//==================================================================================================


//==================================================================================================
// Include directives
//==================================================================================================
#include "fifo.h"

//==================================================================================================
// Local preprocessor definitions
//==================================================================================================


//==================================================================================================
// Local variables
//==================================================================================================


//==================================================================================================
// Local function prototypes
//==================================================================================================


//==================================================================================================
// External variable definitions
//==================================================================================================


//==================================================================================================
// Local function definitions
//==================================================================================================


//==================================================================================================
// External function definitions
//==================================================================================================
void Fifo_Init(FifoType* Fifo, U8* Buffer, const U8 Size)
{
    Fifo->Buffer = Buffer;
    Fifo->Size = Size;
    Fifo->Mask = Size - 1;
    Fifo->Head = 0;
    Fifo->Tail = 0;
}

void Fifo_WriteByte(FifoType* Fifo, U8 Data)
{
    if (Fifo_Full(Fifo)) return;
    Fifo->Buffer[Fifo->Head] = Data;
    Fifo->Head = (Fifo->Head + 1) & Fifo->Mask;
}

void Fifo_ReadByte(FifoType* Fifo, U8* Data)
{
    if (Fifo_Empty(Fifo)) return;
    *Data = Fifo->Buffer[Fifo->Tail];
    Fifo->Tail = (Fifo->Tail + 1) & Fifo->Mask;
}

BOOL Fifo_Empty(FifoType* Fifo)
{
    return (Fifo->Head == Fifo->Tail);
}

BOOL Fifo_Full(FifoType* Fifo)
{
    return (((Fifo->Head + 1) & Fifo->Mask) == Fifo->Tail);
}



